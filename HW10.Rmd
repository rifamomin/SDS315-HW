---
title: "HW10"
author: "Rifa Momin"
date: "2024-04-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(mosaic)
library(tidyverse)
library(ggplot2)
library(knitr)
library(kableExtra)
library(MatchIt)
library(moderndive)
library(effectsize)
redlining <- read.csv("redlining.csv")
groceries <- read.csv("groceries.csv")

```


# Problem 1
 
```{r, echo=FALSE, warning=FALSE, message=FALSE}

ggplot(redlining, aes(x=minority, y =policies)) + geom_point() + labs(title = "Minority Composition vs # of FAIR Policies") + geom_smooth(method="lm")

lm_redlining = lm(policies ~ minority + age + fire + income, data = redlining)

kable(confint(lm_redlining, level = .95))

```

1) Question: The question I am trying to answer is what is the association between number of FAIR policies and minority composition of an area, while also adjusting for fire, age, and income variables.

2) Approach: To solve this question, I first illustrated the relationship between minorities and policies in a scatter plot, then used the lm() function to fit a linear regression model. In this case, policies is the dependent variable and minority is the independent variable, allowing us to estimate the partial relationship between the two variables. Age, fire and income are held constant. Additionally, I ran a confidence interval to determine if the increase (i.e. relationship between minority and policies) is statistically significant

3) Results: The graph shows a positive, linear relationship between minority composition and policies. The results of the linear regression model allow the following formula to be deduced: 

  # of Policies = -0.12 + .008(Minority) + .006(Age) + .02 (Fire) - .02(Income)

The 95% confidence interval also provides the range for which the coefficients for each variable falls within.

4) Conclusion: Positive minority coefficient suggests that increase in minority population is associated with higher number of FAIR policies. We cans say with 95% confidence that the relationship between between minority composition and the number of FAIR policies can be explained by the confidence interval .003 -.014. The positive fire coefficient suggests something similar: higher number of fires associated with greater number of FAIR policies. Age also indicates positive relationship between age and number of FAIR policies. On the other hand, the negative income coefficient suggests that as income increases, the number of FAIR policies decreases.

# Problem 2

## Part A

```{r, echo=FALSE, warning=FALSE, message=FALSE}

avg_prices <- groceries %>% 
  group_by(Store) %>% 
  summarize(averages = mean(Price))

ggplot(avg_prices, aes(y = averages, x = Store)) + geom_col(fill = "pink2") + coord_flip() + labs(X = "Store", y = "Average Price of Products Sold at Store ($)", title = "Average Price of Products by Store", caption = "As the title suggests, this graph illustrates the average price of products sold at different grocery stores. ")
```


## Part B

```{r, echo=FALSE, warning=FALSE, message=FALSE}

stores_selling <- groceries %>% 
  group_by(Product) %>% 
  summarize(num_stores = length((Store)))

ggplot(stores_selling, aes(x = Product, y= num_stores)) + geom_col(fill = "plum3") + coord_flip() + labs(x = "Product", y = "Frequency of Stores Selling the Product", title = "Products and how many stores sell the product", caption = "As the title suggests, the above graph indicates how many stores a particular product is sold at.")


```

## Part C

```{r, echo=FALSE, warning=FALSE, message=FALSE}

lm_type <- lm(Price ~ Type + Product, data = groceries)

table_type = (get_regression_table(lm_type, conf.level = .95, digits = 2))

kable(table_type[1:5,])
```
Compared with ordinary grocery stores (like Albertsons, HEB, or Kroger), convenience stores charge somewhere between .92 and .41 dollars more for the same product.

## Part D

```{r, echo=FALSE, warning=FALSE, message=FALSE}
lm_store <- lm(Price ~ Store + Product, data = groceries)


table_store = (get_regression_table(lm_store, conf.level = .95, digits = 2))

kable(table_store[1:14, ])
```

Looking at the estimates above, Kroger Fresh Fare, Kroger and Fiesta charge the lowest prices by estimated number of -.9, -.7, -.7, respectively. On the other hand, Wheatsville Food Co-Op and Whole Foods charge the highest prices when comparing the same product by .29 and .36, respectively.


## Part E

From the table above, Central Market (-$0.57)
charges more for the same product by .08 compared to HEB (-$0.65).

## Part F

```{r, echo=FALSE, warning=FALSE, message=FALSE}

groc_inc <- groceries %>% 
  mutate(Income10K = Income/10000)


lm_income = lm(Price ~ Income10K + Product, data = groc_inc)

table_income = (get_regression_table(lm_income, digits =3))

kable(table_income[1:2,])

sd_income = standardize_parameters(lm_income)
kable(sd_income[1:2,])

```

The estimated coefficient for Income10K suggests that as price increases, Income10K decreases since the coefficient is negative (-.014). In other words, poorer zip codes seem to pay more for the same product on average. 

A one-standard deviation increase in the income of a zip code seems to be associated with a **-.03** standard deviation change in the price that consumers in that zip code expect to pay for the same product.